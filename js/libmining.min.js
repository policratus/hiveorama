var figue=function(){function e(e,t){var n=e.length;var r=0;for(var i=0;i<n;i++)r+=Math.pow(e[i]-t[i],2);r=Math.sqrt(r);return r}function t(e,t){var n=e.length;var r=0;for(var i=0;i<n;i++)r+=Math.abs(e[i]-t[i]);return r}function n(e,t){var n=e.length;var r=0;for(var i=0;i<n;i++)r=Math.max(r,Math.abs(e[i]-t[i]));return r}function r(e,t){var n=e.length;var r=new Array(n);for(var i=0;i<n;i++)r[i]=e[i]+t[i];return r}function i(e,t){var n=t.length;var r=new Array(n);for(var i=0;i<n;i++)r[i]=e*t[i];return r}function s(e,t){var n=e.length;var r=0;for(var i=0;i<n;i++)r+=e[i]*t[i];return r}function o(e,t){var n="";for(var r=0;r<t;r++)n+=e;return n}function u(e,t,n,r){var i=new Array(t.length);var s=e+n;for(var o=0;o<t.length;o++)i[o]=(e*t[o]+n*r[o])/s;return i}function a(e,t){var n=t-e.length;if(n<0)return;var r=Math.floor(n/2);return o(" ",r)+e+o(" ",n-r)}function f(e,t,n){var r=t-e.length;if(r<0)return;return o(" ",n)+e+o(" ",t-(e.length+n))}function l(e){var t=new Array(e.length);var n=Math.pow(10,figue.PRINT_VECTOR_VALUE_PRECISION);for(var r=0;r<e.length;r++)t[r]=Math.round(e[r]*n)/n;return t.join(",")}function c(e){var t=Math.pow(10,figue.PRINT_VECTOR_VALUE_PRECISION);return String(Math.round(e*t)/t)}function h(r,i,s,o){var a=i.length;var f=new Array(a);var l=new Array(a);var c=new figue.Matrix(a,a);var h=c.mtx;var p=new Array(a);var d,v,g,y,b,w,E,S,x;if(s==figue.EUCLIDIAN_DISTANCE)s=e;else if(s==figue.MANHATTAN_DISTANCE)s=t;else if(s==figue.MAX_DISTANCE)s=n;for(b=0;b<a;b++){f[b]=0;for(w=0;w<a;w++){if(b==w)h[b][w]=Infinity;else h[b][w]=s(i[b],i[w]);if(h[b][f[b]]>h[b][w])f[b]=w}}for(b=0;b<a;b++){p[b]=[];p[b][0]=new m(r[b],null,null,0,i[b]);l[b]=1}for(E=0;E<a-1;E++){d=0;for(b=0;b<a;b++){if(h[b][f[b]]<h[d][f[d]])d=b}v=f[d];g=p[d][0];y=p[v][0];x=u(g.size,g.centroid,y.size,y.centroid);newCluster=new m(-1,g,y,h[d][v],x);p[d].splice(0,0,newCluster);l[d]+=l[v];for(w=0;w<a;w++){if(o==figue.SINGLE_LINKAGE){if(h[d][w]>h[v][w])h[w][d]=h[d][w]=h[v][w]}else if(o==figue.COMPLETE_LINKAGE){if(h[d][w]<h[v][w])h[w][d]=h[d][w]=h[v][w]}else if(o==figue.AVERAGE_LINKAGE){var T=(l[d]*h[d][w]+l[v]*h[v][w])/(l[d]+l[w]);h[w][d]=h[d][w]=T}}h[d][d]=Infinity;for(b=0;b<a;b++)h[b][v]=h[v][b]=Infinity;for(w=0;w<a;w++){if(f[w]==v)f[w]=d;if(h[d][w]<h[d][f[d]])f[d]=w}S=newCluster}return S}function p(e,t){var n=t.length;if(e>n)return null;var r=new Array(e);var i=new Array(e);var s=new Object;var o=0;var u=0;var a,f,l;while(u<e){if(o==n)return null;var c=Math.floor(Math.random()*n);if(c in s)continue;s[c]=1;o++;f=t[c];l=true;for(a=0;a<u;a++){if(f.compare(r[a])){l=false;break}}if(l){r[u]=f;i[u]=c;u++}}return{vectors:r,indices:i}}function d(t,n){buttonTracking("kmeans");var s=n.length;var o=new Array(s);var u=new Array(t);var a=true;var f=0;var l=null;var c=p(t,n);if(c==null)return null;else l=c.vectors;while(a){for(var h=0;h<t;h++)u[h]=0;for(var d=0;d<s;d++){var v=n[d];var m=Number.MAX_VALUE;var g;for(var h=0;h<t;h++){dist=e(l[h],v);if(dist<m){m=dist;g=h}}u[g]++;o[d]=g}var y=new Array(t);for(var h=0;h<t;h++)y[h]=null;for(var d=0;d<s;d++){cluster=o[d];if(y[cluster]==null)y[cluster]=n[d];else y[cluster]=r(y[cluster],n[d])}for(var h=0;h<t;h++){y[h]=i(1/u[h],y[h])}a=false;for(var h=0;h<t;h++){if(!y[h].compare(l[h])){a=true;break}}l=y;f++;if(f>figue.KMEANS_MAX_ITERATIONS)a=false}return{centroids:l,assignments:o}}function v(e,t){this.rows=e;this.cols=t;this.mtx=new Array(e);for(var n=0;n<e;n++){var r=new Array(t);for(var i=0;i<t;i++)r[i]=0;this.mtx[n]=r}}function m(e,t,n,r,i){this.label=e;this.left=t;this.right=n;this.dist=r;this.centroid=i;if(t==null&&n==null){this.size=1;this.depth=0}else{this.size=t.size+n.size;this.depth=1+Math.max(t.depth,n.depth)}}return{SINGLE_LINKAGE:0,COMPLETE_LINKAGE:1,AVERAGE_LINKAGE:2,EUCLIDIAN_DISTANCE:0,MANHATTAN_DISTANCE:1,MAX_DISTANCE:2,PRINT_VECTOR_VALUE_PRECISION:2,KMEANS_MAX_ITERATIONS:10,Matrix:v,Node:m,agglomerate:h,kmeans:d}}();figue.Matrix.prototype.toString=function(){var e=[];for(var t=0;t<this.rows;t++)e.push(this.mtx[t].join("	"));return e.join("\n")};figue.Matrix.prototype.copy=function(){var e=new figue.Matrix(this.rows,this.cols);for(var t=0;t<this.rows;t++)e.mtx[t]=this.mtx[t].slice(0);return e};figue.Node.prototype.isLeaf=function(){if(this.left==null&&this.right==null)return true;else return false};Array.prototype.compare=function(e){if(this.length!=e.length)return false;for(var t=0;t<e.length;t++){if(this[t].compare){if(!this[t].compare(e[t]))return false}if(this[t]!==e[t])return false}return true}